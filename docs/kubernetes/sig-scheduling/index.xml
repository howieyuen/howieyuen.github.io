<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>sig-scheduling on 袁昊的学习笔记</title>
    <link>https://howieyuen.github.io/docs/kubernetes/sig-scheduling/</link>
    <description>Recent content in sig-scheduling on 袁昊的学习笔记</description>
    <generator>Hugo -- gohugo.io</generator>
    <lastBuildDate>Sun, 22 Mar 2020 00:00:00 +0000</lastBuildDate><atom:link href="https://howieyuen.github.io/docs/kubernetes/sig-scheduling/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>高级调度</title>
      <link>https://howieyuen.github.io/docs/kubernetes/sig-scheduling/advanced-scheduling/</link>
      <pubDate>Sun, 22 Mar 2020 00:00:00 +0000</pubDate>
      
      <guid>https://howieyuen.github.io/docs/kubernetes/sig-scheduling/advanced-scheduling/</guid>
      <description>1. 使用taint和toleration阻止节点调度到特定节点 #  1.1 taint和toleration #  taint，是在不修改已有pod的前提下，通过在节点上添加污点信息，拒绝pod的部署。只有当一个pod容忍某个节点的taint时，才能被调度到此节点上。
显示节点taint信息
kubectl describe node master.k8s ... Name: master.k8s Role: Labels: beta.kubernetes.io/arch=amd64 beta.kubernetes.io/os=linux kubernetes.io/hostname=master.k8s Annotations: node.alpha.kubernetes.io/ttl=0 Taints: node-role.kubernetes.io/master:NoSchedule ... 主节点上包含一个污点，污点包含一个key和value，以及一个effect，格式为=:。上面的污点信息表示，key为node-role.kubernetes.io/master，value是空，effect是NoSchedule。
显示pod tolerations
kubectl describe pod kube-proxy-as92 -n kube-system ... Tolerations: node-role.kubernetes.io/master:=NoSchedule node.alpha.kubernetes.io/notReady=:Exists:NoExecute node.alpha.kubernetes.io/unreachable=:Exists:NoExecute ... 第一个toleration匹配了主节点的taint，表示允许这个pod调度到主节点上。
了解污点效果 另外2个在kube-proxy pod上容忍定义了当前节点状态是没有ready或者是unreachable时，该pod允许运行在该节点上多长时间。 污点可以包含以下三种效果：
 NoSchedule，表示如果pod没有容忍此污点，将无法调度 PreferNoSchedule，是上面的宽松版本，如果没有其他节点可调度，依旧可以调度到本节点 NoExecute，上2个在调度期间起作用，而此设定也会影响正在运行中的pod。如果节点上的pod没有容忍此污点，会被驱逐。   1.2 在节点上定义污点 #  kubectl taint node node1.k8s node-type=production:NoSchedule 此命令给节点添加污点，key为node-type，value为production，effect为NoSchedule。如果现在部署一个常规pod多个副本，没有一个pod会调度到此节点上。
1.3 在pod上添加容忍 #  apiVersion: apps/v1 kind: Deployment metadata: name: prod spec: replicas: 5 template: spec: .</description>
    </item>
    
  </channel>
</rss>
